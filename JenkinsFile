pipeline {
    agent any
    
    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }
        
        stage('Compile') {
            steps {
                sh 'javac src/*.java'
            }
        }
        
        stage('Test') {
            steps {
                sh 'java -cp src org.junit.runner.JUnitCore test.TestSuite'
            }
        }
        
        stage('Package') {
            steps {
                sh 'mkdir -p build/libs'
                sh 'jar cvf build/libs/myapp.jar src/*.class'
            }
            post {
                always {
                    archiveArtifacts 'build/libs/*.jar'
                }
            }
        }
    }
}
